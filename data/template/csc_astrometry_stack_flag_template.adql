SELECT DISTINCT dbo.separation(m.ra,m.dec,266.599396,-28.87594) as separation,m.name,m.ra,m.dec,m.err_ellipse_r0,m.err_ellipse_r1,m.err_ellipse_ang,m.significance,m.likelihood_class,m.conf_flag,m.sat_src_flag,m.streak_src_flag,s.detect_stack_id,s.ra_stack,s.dec_stack,s.instrument,s.grating,s.region_id,s.ra,s.dec,s.err_ellipse_r0,s.err_ellipse_r1,s.err_ellipse_ang,s.theta_mean,s.flux_significance_b,s.detect_significance_b,s.likelihood_b,s.likelihood_class,s.conf_code,s.dither_warning_flag,s.edge_code,s.extent_code,s.multi_chip_code,s.pileup_flag,s.sat_src_flag,s.streak_src_flag,s.var_flag,s.var_inter_hard_flag,s.man_add_flag,s.man_inc_flag,s.man_pos_flag,s.man_reg_flag,a.match_type FROM master_source m , master_stack_assoc a , stack_source s WHERE ((( ( m.dec BETWEEN -28.884273333333333 AND -28.867606666666667 ) AND ( m.ra BETWEEN 266.5898794490786 AND 266.60891255092145 ) ) AND dbo.cone_distance(m.ra,m.dec,266.599396,-28.87594)<=0.543215)) AND (m.name = a.name) AND (s.detect_stack_id = a.detect_stack_id and s.region_id = a.region_id)ORDER BY separation ASC, name ASC
